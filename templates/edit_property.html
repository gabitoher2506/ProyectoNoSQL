{% extends "base.html" %}

{% block title %}Editar Propiedad{% endblock %}

{% block content %}
<div class="property-edit-container">
    <h1 class="property-edit-title">Editar Propiedad</h1>
    <form action="{{ url_for('edit_property', property_id=property_id) }}" method="POST" enctype="multipart/form-data" class="property-edit-form">
        
        <div class="form-group">
            <label for="name" class="form-label">Nombre:</label>
            <input type="text" id="name" name="name" value="{{ property['name'] }}" class="form-input" required>
        </div>
        
        <div class="form-group">
            <label for="price" class="form-label">Precio:</label>
            <input type="number" id="price" name="price" step="0.01" value="{{ property['price'] }}" class="form-input" required>
        </div>
        
        <div class="form-group">
            <label for="transaction_type" class="form-label">Tipo de Transacción:</label>
            <input type="text" id="transaction_type" name="transaction_type" value="{{ property['transaction_type'] }}" class="form-input" required>
        </div>
        
        <div class="form-group">
            <label for="antiquity" class="form-label">Años de Antigüedad:</label>
            <input type="number" id="antiquity" name="antiquity" value="{{ property['antiquity'] }}" class="form-input" required>
        </div>
        
        <div class="form-group">
            <label for="owner" class="form-label">Propietario:</label>
            <input type="text" id="owner" name="owner" value="{{ property['owner'] }}" class="form-input" required>
        </div>

        <div class="form-group">
            <label class="form-label">Imágenes actuales:</label>
            <div class="property-images">
                {% for image in property['images'] %}
                <div class="property-image-container">
                    <img src="{{ image }}" alt="Imagen de la propiedad" class="property-image">
                    <button type="button" class="remove-image-btn" onclick="removeImage('{{ image }}')">Eliminar</button>
                    <input type="hidden" name="existing_images" value="{{ image }}" class="hidden-image-input">
                </div>
                {% endfor %}
            </div>
        </div>

        <div class="form-group">
            <label for="new_image" class="form-label">Nueva Imagen (URL):</label>
            <input type="text" id="new_image" name="new_image" class="form-input">
        </div>

        <div class="form-group">
            <input type="submit" value="Guardar Cambios" class="submit-btn">
        </div>
    </form>
</div>

<script>
    function removeImage(imageUrl) {
        const inputs = document.querySelectorAll(`input[value='${imageUrl}']`);
        inputs.forEach(input => input.remove());
        const images = document.querySelectorAll(`img[src='${imageUrl}']`);
        images.forEach(image => image.remove());
        const buttons = document.querySelectorAll(`button[onclick="removeImage('${imageUrl}')"]`);
        buttons.forEach(button => button.remove());
    }
</script>
{% endblock %}
